<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>å—éƒ¨èˆªå‹™ä¸­å¿ƒ115å¹´å“¡å·¥è¯èª¼æš¨CIQSèŒ¶æœƒäººå“¡é…ç½®åœ–</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background: #f5f5f5; display: flex; padding: 20px; gap: 20px; margin: 0; height: 100vh; overflow: hidden; }
        
        /* å·¦å´ç®¡ç†é¢æ¿ */
        .admin-panel { 
            width: 340px; background: #fff; padding: 20px; border-radius: 8px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); height: 95vh; 
            display: flex; flex-direction: column; transition: 0.3s;
        }
        
        textarea { flex-grow: 1; width: 100%; font-family: monospace; padding: 10px; border: 1px solid #ccc; font-size: 13px; resize: none; border-radius: 4px; box-sizing: border-box; }
        .stats-summary { margin-top: 10px; padding: 10px; background: #f1f8e9; border-radius: 4px; font-size: 13px; font-weight: bold; border-left: 4px solid #4caf50; }
        
        /* å³å´åœ–è¡¨å€ */
        .chart-container { 
            flex-grow: 1; display: flex; flex-direction: column; align-items: center; 
            gap: 30px; overflow-y: auto; height: 95vh; transition: 0.3s;
        }
        
        .canvas { width: 950px; background: white; border: 2px solid #333; padding: 40px; position: relative; flex-shrink: 0; }
        .top-row { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 30px; }
        .restroom-box { border: 1px solid #000; padding: 8px; width: 60px; text-align: center; font-weight: bold; font-size: 13px; }
        .stage-box { background: red; color: white; padding: 15px 90px; font-weight: bold; border: 1px solid #000; font-size: 22px; }
        .main-layout { display: flex; min-height: 750px; position: relative; }
        .left-facilities { width: 80px; display: flex; flex-direction: column; justify-content: center; }
        .elevator-box { border: 1px solid #000; padding: 15px 5px; text-align: center; background: #eee; font-weight: bold; font-size: 13px; }
        .guide-wall { width: 8px; background: #000; margin: 0 35px; border-radius: 0 0 4px 4px; height: 680px; }
        .seating-area { flex-grow: 1; display: flex; flex-direction: column; align-items: center; }
        
        /* åº§ä½åœˆåœˆ */
        .main-table-circle { width: 180px; height: 180px; border-radius: 50%; border: 3px solid #1976d2; background: #e3f2fd; display: flex; align-items: center; justify-content: center; font-weight: 900; font-size: 24px; margin-bottom: 40px; text-align: center; color: #0d47a1; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .guest-grid { display: grid; grid-template-columns: repeat(4, 180px); gap: 15px 25px; align-items: center; }
        .table-circle { width: 140px; height: 140px; border-radius: 50%; border: 2px solid #666; background: radial-gradient(circle, #ffffff, #f0f4f8); display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .table-circle b { font-size: 18px; color: #000; border-bottom: 2px solid #ccc; width: 85%; margin-bottom: 6px; font-weight: 900; }
        .unit-list { font-size: 13px; line-height: 1.4; color: #222; font-weight: bold; }
        
        .vip-line { grid-column: span 4; border-top: 2px dashed #d32f2f; text-align: center; font-size: 16px; font-weight: 900; color: #d32f2f; padding: 15px 0; margin: 15px 0; }
        .pillar { background: #ffe0b2 !important; border: 1px solid #fb8c00; font-weight: 900; color: #e65100; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .bottom-row { margin-top: 40px; display: flex; justify-content: center; width: 100%; }
        .reception-group { display: flex; border: 2px solid #000; background: #fff; }
        .reception-box { border: 1px solid #000; padding: 15px 70px; font-weight: 900; font-size: 18px; }
        .footer { margin-top: 40px; text-align: center; border-top: 3px solid #000; padding-top: 25px; width: 100%; }
        .summary-panel { width: 950px; background: white; border: 1px solid #333; padding: 35px; flex-shrink: 0; margin-bottom: 50px; }
        .summary-grid { display: grid; grid-template-columns: 1.2fr 1.8fr; gap: 40px; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #f9f9f9; font-weight: 900; }
        .error { color: #d32f2f; font-weight: bold; background: #fffde7; }
        .success { color: #2e7d32; font-weight: bold; }
        .notice-text { color: #d32f2f; font-weight: 900; margin: 10px 0; font-size: 15px; }

        /* --- æŠ•å½±æ¨¡å¼åˆ‡æ›æŒ‰éˆ• --- */
        .toggle-btn {
            position: fixed; top: 10px; right: 20px; z-index: 1000;
            padding: 10px 20px; background: #333; color: white;
            border: none; border-radius: 30px; cursor: pointer;
            font-weight: bold; box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: 0.3s;
        }
        .toggle-btn:hover { background: #000; transform: scale(1.05); }

        /* --- æŠ•å½±æ¨¡å¼æ¨£å¼ (ä¿®æ­£ç‰ˆ) --- */
        /* 1. åªéš±è—å·¦å´æ§åˆ¶å° */
        body.presentation-mode .admin-panel {
            display: none !important;
        }
        
        /* 2. å³å´å€åŸŸè¨­å®šï¼šå…è¨±æ²å‹•ã€å¯¬åº¦æ»¿ç‰ˆ */
        body.presentation-mode .chart-container {
            width: 100%; 
            max-width: 100%; 
            height: 100vh;
            justify-content: flex-start; /* æ”¹ç‚ºå¾é ­é–‹å§‹æ’åˆ—ï¼Œé¿å…ä¸­é–“å°é½Šå°è‡´ä¸Šæ–¹è¢«åˆ‡æ‰ */
            overflow-y: auto; /* é—œéµï¼šå…è¨±å‚ç›´æ²å‹• */
            padding-bottom: 50px; /* åº•éƒ¨ç•™ç™½ */
        }

        /* 3. èƒŒæ™¯èˆ‡ç¸®æ”¾ */
        body.presentation-mode {
            background: #fff; 
            padding: 0;
        }
        body.presentation-mode .canvas {
            border: none;
            box-shadow: none;
            margin-top: 20px;
            /* ç¨å¾®ç¸®å°ä¸€é»è®“è¦–é‡å¥½ä¸€é»ï¼Œä½†ä¿æŒå¯è®€æ€§ */
            transform: scale(0.95); 
            transform-origin: top center;
        }
        
        /* 4. éš±è—æ²è»¸ä½†ä¿ç•™åŠŸèƒ½ (ç¾è§€) */
        body.presentation-mode .chart-container::-webkit-scrollbar {
            width: 8px;
        }
        body.presentation-mode .chart-container::-webkit-scrollbar-thumb {
            background: #ccc; 
            border-radius: 4px;
        }

        @media print {
            body { display: block; background: white; padding: 0; margin: 0; }
            .admin-panel, .toggle-btn, button { display: none !important; }
            .chart-container { display: block; height: auto; overflow: visible; width: 100%; }
            .canvas, .summary-panel { border: none; box-shadow: none; width: 100%; margin: 0 auto; page-break-after: always; }
            .canvas { transform: scale(0.85); transform-origin: top center; }
        }
    </style>
</head>
<body>

<button class="toggle-btn" onclick="togglePresentation()">ğŸ“º åˆ‡æ›æŠ•å½±æ¨¡å¼</button>

<div class="admin-panel">
    <h3>åå–®è³‡æ–™åº«æ¨™è¨˜ (Tag)</h3>
    <textarea id="dataInput" oninput="updateAll()" placeholder="æ ¼å¼ï¼šå§“å,æ¡Œè™Ÿ">å±€é•·è‘‰å”éš†,ä¸»
ä¸»ä»»å¼µåšå½¥,ä¸»
å‰ä¸»ç§˜ä½™å»ºå‹³,ä¸»
åœ‹éš›è¼ªèˆ¹ç†äº‹é•·,ä¸»
å€‰åº«å…¬æœƒç†äº‹é•·,ä¸»
è£å¸å…¬æœƒç†äº‹é•·,ä¸»
ç†è²¨å…¬æœƒç†äº‹é•·,ä¸»
èˆ¹ä»£å…¬æœƒç†äº‹é•·,ä¸»
å¼•æ°´äººå…¬æœƒä¸»ä»»,ä¸»
CDC,ä¸»
CRé©—èˆ¹ä¸­å¿ƒè™•é•·,ä¸»
æ¸¯å‹™æ¶ˆé˜²æˆ´å‰¯å¤§éšŠé•·,ä¸»

å‰¯ä¸»ä»»,4
æ¸¯æ”¿ç§‘ç§‘é•·,4
æ¸¯æ”¿ç§‘è¦–å¯Ÿ,4
æ¸¯æ”¿ç§‘å°ˆå“¡,4
æ¸¯æ”¿ç§‘å°ˆå“¡,4
ç›£ç†ç§‘å°ˆå“¡,4
CDC,4
è£å¸å…¬æœƒ,4
è£å¸å…¬æœƒ,4
è£å¸å…¬æœƒ,4

éƒ­ç°¡ä»»æŠ€æ­£,3
èˆªå®‰ç§‘å°ˆå“¡,3
èˆªå®‰ç§‘å°ˆå“¡,3
èˆªå®‰ç§‘,3
è£å¸å…¬æœƒ,3
è£å¸å…¬æœƒ,3
è£å¸å…¬æœƒ,3
å¼•æ°´äººå…¬æœƒææ±¶å½¥,3
å¼•æ°´äººå…¬æœƒæå´‡å²±,3
åœ‹éš›è¼ªèˆ¹ç¸½å¹¹äº‹,3

é»ƒç°¡ä»»æŠ€æ­£,2
æµ·æŠ€ç§‘ç§‘é•·,2
æµ·æŠ€ç§‘æŠ€æ­£,2
æµ·æŠ€ç§‘æŠ€æ­£,2
æµ·æŠ€ç§‘å°ˆå“¡,2
CRé©—èˆ¹ä¸­å¿ƒ,2
æ¸¯å‹¤å…¬å¸,2
æ¸¯å‹¤å…¬å¸,2
ä½™å»ºå‹³å¤«äºº,2
å±€é•·éš¨è¡Œç§˜æ›¸,2

å³å°ˆé–€å§”å“¡,1
å®‰å¹³èˆªæ¸¯ç§‘ç§‘é•·,1
å®‰å¹³èˆªæ¸¯ç§‘æŠ€æ­£,1
å®‰å¹³èˆªæ¸¯ç§‘è¦–å¯Ÿ,1
å®‰å¹³èˆªæ¸¯ç§‘å°ˆå“¡,1
ç›£ç†ç§‘ç§‘é•·,1
ç›£ç†ç§‘è¦–å¯Ÿ,1
èˆ¹ä»£å…¬æœƒ,1
èˆ¹ä»£å…¬æœƒ,1
èˆ¹ä»£å…¬æœƒ,1

èˆªå®‰ç§‘,7
èˆªå®‰ç§‘,7
èˆªå®‰ç§‘,7
èˆªå®‰ç§‘,7
èˆªå®‰ç§‘,7
èˆªå®‰ç§‘,7
èˆªå®‰ç§‘,7
èˆªå®‰ç§‘,7
èˆªå®‰ç§‘,7
èˆªå®‰ç§‘,7
èˆªå®‰ç§‘(ç´ é£Ÿ),7

èˆªå®‰ç§‘,11
èˆªå®‰ç§‘,11
èˆªå®‰ç§‘,11
èˆªå®‰ç§‘,11
èˆªå®‰ç§‘,11
èˆªå®‰ç§‘,11
èˆªå®‰ç§‘,11
èˆªå®‰ç§‘,11
èˆªå®‰ç§‘,11
èˆªå®‰ç§‘(ç´ é£Ÿ),11

ç›£ç†ç§‘,5
ç›£ç†ç§‘,5
ç›£ç†ç§‘,5
ç›£ç†ç§‘,5
ç›£ç†ç§‘,5
ç›£ç†ç§‘,5
ç›£ç†ç§‘,5
ç›£ç†ç§‘,5
ç›£ç†ç§‘,5

æ¸¯æ”¿ç§‘,8
æ¸¯æ”¿ç§‘,8
æ¸¯æ”¿ç§‘,8
æ¸¯æ”¿ç§‘,8
æ¸¯æ”¿ç§‘,8
æ¸¯æ”¿ç§‘,8
æ¸¯æ”¿ç§‘,8
æ¸¯æ”¿ç§‘,8
æ¸¯æ”¿ç§‘,8
æ¸¯æ”¿ç§‘,8

æµ·æŠ€ç§‘,6
æµ·æŠ€ç§‘,6
æµ·æŠ€ç§‘,6
æµ·æŠ€ç§‘,6
æµ·æŠ€ç§‘,6
æµ·æŠ€ç§‘,6
æµ·æŠ€ç§‘,6
æµ·æŠ€ç§‘,6
æµ·æŠ€ç§‘,6
æµ·æŠ€ç§‘,6

æµ·æŠ€ç§‘,9
æµ·æŠ€ç§‘,9
æµ·æŠ€ç§‘,9
æµ·æŠ€ç§‘,9
æµ·æŠ€ç§‘,9
æµ·æŠ€ç§‘,9
æµ·æŠ€ç§‘,9
æµ·æŠ€ç§‘,9
æµ·æŠ€ç§‘,9
æ”¿é¢¨,9

å®‰å¹³èˆªæ¸¯ç§‘,10
å®‰å¹³èˆªæ¸¯ç§‘,10
å®‰å¹³èˆªæ¸¯ç§‘,10
å®‰å¹³èˆªæ¸¯ç§‘,10
å®‰å¹³èˆªæ¸¯ç§‘,10
å®‰å¹³èˆªæ¸¯ç§‘,10
æ¸¯æ”¿ç§‘,10
æ¸¯æ”¿ç§‘,10
å®‰å¹³èˆªæ¸¯ç§‘,10
å®‰å¹³èˆªæ¸¯ç§‘,10</textarea>
    <div class="stats-summary" id="quickStats">å·²æ’äººæ•¸ï¼š122 / 122äºº</div>
    <button onclick="window.print()" style="margin-top:15px; padding:12px; background:#333; color:white; border:none; border-radius:4px; cursor:pointer; font-weight:bold;">åˆ—å°å®Œæ•´å ±è¡¨</button>
</div>

<div class="chart-container">
    <div class="canvas">
        <div class="top-row">
            <div style="display:flex; gap:8px;"><div class="restroom-box">å¥³å»</div><div class="restroom-box">ç”·å»</div></div>
            <div class="stage-box">èˆ å°</div>
            <div style="border:1px solid #000; padding:8px; background:#eee; font-size:12px; font-weight:bold;">éŸ³æ§å°</div>
        </div>
        <div class="main-layout">
            <div class="left-facilities"><div class="elevator-box">â‡… é›»æ¢¯</div></div>
            <div class="guide-wall"></div>
            <div class="seating-area">
                <div class="main-table-circle">ä¸»æ¡Œ<br>é•·å®˜è²´è³“</div>
                <div class="guest-grid">
                    <div class="table-circle"><b>ç¬¬ 1 æ¡Œ</b><div class="unit-list" id="map-1"></div></div>
                    <div class="table-circle"><b>ç¬¬ 2 æ¡Œ</b><div class="unit-list" id="map-2"></div></div>
                    <div class="table-circle"><b>ç¬¬ 3 æ¡Œ</b><div class="unit-list" id="map-3"></div></div>
                    <div class="table-circle"><b>ç¬¬ 4 æ¡Œ</b><div class="unit-list" id="map-4"></div></div>
                    <div class="vip-line">------------------ å°ˆå“¡ä»¥ä¸Šè«‹åå‰å››æ¡Œæ¥­å‹™äº¤æµå€ ------------------</div>
                    <div class="table-circle"><b>ç¬¬ 5 æ¡Œ</b><div class="unit-list" id="map-5"></div></div>
                    <div class="table-circle"><b>ç¬¬ 6 æ¡Œ</b><div class="unit-list" id="map-6"></div></div>
                    <div class="table-circle"><b>ç¬¬ 7 æ¡Œ</b><div class="unit-list" id="map-7"></div></div>
                    <div class="table-circle"><b>ç¬¬ 8 æ¡Œ</b><div class="unit-list" id="map-8"></div></div>
                    <div class="table-circle"><b>ç¬¬ 9 æ¡Œ</b><div class="unit-list" id="map-9"></div></div>
                    <div class="table-circle pillar">æŸ± å­</div>
                    <div class="table-circle"><b>ç¬¬ 10 æ¡Œ</b><div class="unit-list" id="map-10"></div></div>
                    <div class="table-circle"><b>ç¬¬ 11 æ¡Œ</b><div class="unit-list" id="map-11"></div></div>
                </div>
            </div>
        </div>
        <div class="bottom-row"><div class="reception-group"><div class="reception-box">æ¥ å¾… è™•</div><div class="reception-box">æ¥ å¾… è™•</div></div></div>
        <div class="footer">
            <div style="font-size:18px; font-weight:bold;">äº¤é€šéƒ¨èˆªæ¸¯å±€å—éƒ¨èˆªå‹™ä¸­å¿ƒ</div>
            <h2 style="margin:8px 0;">115å¹´å“¡å·¥è¯èª¼æ´»å‹•æš¨CIQSèŒ¶æœƒ</h2>
            <p>115.1.23 (äº”) 18:00 å…¥å ´ / 18:30 é–‹å§‹ | åœ°é»ï¼šé«˜é›„ç¿°å“é…’åº— 4æ¨“å…†æ…¶å»³ (å¤§ä»è·¯43è™Ÿ)</p>
        </div>
    </div>

    <div class="summary-panel">
        <div class="summary-grid">
            <div>
                <h3>1. å–®ä½æŸ¥æ ¸ (äººæ•¸çµ±è¨ˆ)</h3>
                <table id="statsTable">
                    <thead><tr><th>å–®ä½/è·ç¨±</th><th>é è¨ˆ</th><th>å¯¦æ’</th><th>ç‹€æ…‹</th><th>æ¡Œæ¬¡</th></tr></thead>
                    <tbody id="statsBody"></tbody>
                </table>
            </div>
            <div>
                <h3>2. è³“å®¢æ˜ç´° (è©³ç´°æ¸…å–®)</h3>
                <div class="notice-text">â€» 5~11æ¡Œä½ç½®å¯ç¶“é›™æ–¹åŒæ„è‡ªè¡Œå°èª¿èª¿æ•´</div>
                <div id="indexContainer" style="font-size:13px; line-height:1.7;"></div>
            </div>
        </div>
    </div>
</div>

<script>
    // åˆ‡æ›æŠ•å½±æ¨¡å¼ JS
    function togglePresentation() {
        document.body.classList.toggle('presentation-mode');
        const btn = document.querySelector('.toggle-btn');
        if (document.body.classList.contains('presentation-mode')) {
            btn.innerText = "ğŸ”§ å›åˆ°ç·¨è¼¯æ¨¡å¼";
            btn.style.opacity = "0.3"; 
        } else {
            btn.innerText = "ğŸ“º åˆ‡æ›æŠ•å½±æ¨¡å¼";
            btn.style.opacity = "1";
        }
    }

    // å®šç¾©é¡åˆ¥èˆ‡é—œéµå­—
    const unitExpect = [
        { name: "å±€é•·", count: 1 },
        { name: "éš¨è¡Œç§˜æ›¸", count: 1, keys: ["å±€é•·éš¨è¡Œç§˜æ›¸"] },
        { name: "ä¸»ä»»", count: 1 },
        { name: "å‰¯ä¸»ä»»", count: 1 }, 
        { name: "ç°¡ä»»æŠ€æ­£", count: 2 },
        { name: "å°ˆé–€å§”å“¡", count: 1, keys: ["å°ˆé–€å§”å“¡","å°ˆå§”"] },
        { name: "å‰ä¸»ç¥•ä½™å»ºå‹³(å«å¤«äºº)", count: 2, keys: ["ä½™å»ºå‹³", "å¤«äºº"] },
        { name: "å¼•æ°´äººå…¬æœƒ", count: 3, keys: ["å¼•æ°´äºº"] },
        { name: "èˆªå®‰ç§‘", count: 24, keys: ["èˆªå®‰"] }, 
        { name: "æµ·æŠ€ç§‘", count: 23, keys: ["æµ·æŠ€"] }, 
        { name: "æ¸¯æ”¿ç§‘", count: 16, keys: ["æ¸¯æ”¿"] },
        { name: "ç›£ç†ç§‘", count: 12, keys: ["ç›£ç†"] }, 
        { name: "å®‰å¹³èˆªæ¸¯ç§‘", count: 12, keys: ["å®‰å¹³"] }, 
        { name: "è£å¸å…¬æœƒ", count: 7 },
        { name: "èˆ¹ä»£å…¬æœƒ", count: 4, keys: ["èˆ¹ä»£"] }, 
        { name: "CDC", count: 2 }, 
        { name: "åœ‹éš›è¼ªèˆ¹", count: 2 },
        { name: "æ¸¯å‹¤å…¬å¸", count: 2, keys: ["æ¸¯å‹¤"] }, 
        { name: "é©—èˆ¹ä¸­å¿ƒ", count: 2, keys: ["é©—èˆ¹ä¸­å¿ƒ", "CRé©—èˆ¹"] }, 
        { name: "æ”¿é¢¨", count: 1 },
        { name: "æ¶ˆé˜²", count: 1, keys: ["æ¶ˆé˜²"] }, 
        { name: "å€‰åº«å…¬æœƒ", count: 1, keys: ["å€‰åº«"] }, 
        { name: "ç†è²¨å…¬æœƒ", count: 1, keys: ["ç†è²¨"] }
    ];

    function updateAll() {
        const text = document.getElementById('dataInput').value;
        const lines = text.split('\n');
        const tables = { 'ä¸»': [], '1': [], '2': [], '3': [], '4': [], '5': [], '6': [], '7': [], '8': [], '9': [], '10': [], '11': [] };
        const unitActual = unitExpect.map(u => ({ ...u, actual: 0, tableSet: new Set() }));
        let totalCount = 0;

        lines.forEach(line => {
            const parts = line.split(/[,\s\t]+/);
            if (parts.length >= 2) {
                const tableNum = parts[parts.length - 1].trim();
                const name = parts.slice(0, parts.length - 1).join(' ').trim();
                if (tables[tableNum] && name) {
                    tables[tableNum].push(name); totalCount++;
                    const sortedExpect = [...unitExpect].sort((a,b) => {
                        const lenA = a.keys ? a.keys[0].length : a.name.length;
                        const lenB = b.keys ? b.keys[0].length : b.name.length;
                        return lenB - lenA;
                    });
                    for (let uRef of sortedExpect) {
                        const keys = uRef.keys || [uRef.name];
                        if (keys.some(k => name.includes(k))) {
                            const u = unitActual.find(item => item.name === uRef.name);
                            u.actual++;
                            u.tableSet.add(tableNum);
                            break; 
                        }
                    }
                }
            }
        });

        document.getElementById('quickStats').innerText = `å·²æ’äººæ•¸ï¼š${totalCount} / 122äºº`;
        const statsBody = document.getElementById('statsBody'); statsBody.innerHTML = '';
        unitExpect.forEach(uRef => {
            const u = unitActual.find(item => item.name === uRef.name);
            const isMatch = u.actual === uRef.count;
            const status = isMatch ? '<span class="success">âœ” OK</span>' : `<span class="error">âœ˜ å·®${uRef.count - u.actual}</span>`;
            statsBody.innerHTML += `<tr><td>${u.name}</td><td>${uRef.count}</td><td>${u.actual}</td><td>${status}</td><td>${Array.from(u.tableSet).sort().join(',')}</td></tr>`;
        });

        const indexContainer = document.getElementById('indexContainer'); indexContainer.innerHTML = '';
        const displayOrder = ['ä¸»', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11'];
        
        displayOrder.forEach(key => {
            if (!tables[key]) return;
            const mapEl = document.getElementById('map-' + key);
            if (mapEl) {
                const labelsInTable = [];
                tables[key].forEach(name => {
                    const sortedExpect = [...unitExpect].sort((a,b) => {
                        const lenA = a.keys ? a.keys[0].length : a.name.length;
                        const lenB = b.keys ? b.keys[0].length : b.name.length;
                        return lenB - lenA;
                    });
                    
                    for (let uRef of sortedExpect) {
                        const keys = uRef.keys || [uRef.name];
                        if (keys.some(k => name.includes(k))) {
                            let label = uRef.name;
                            
                            // *** é¡¯ç¤ºåç¨±å®¢è£½åŒ– ***
                            if (uRef.name === "å‰ä¸»ç¥•ä½™å»ºå‹³(å«å¤«äºº)") {
                                if (name.includes("å¤«äºº")) label = "å‰ä¸»ç§˜å¤«äºº";
                                else label = "å‰ä¸»ç¥•";
                            }
                            if (uRef.name === "éš¨è¡Œç§˜æ›¸") label = "å±€é•·éš¨è¡Œç§˜æ›¸"; 
                            
                            if (!labelsInTable.includes(label)) labelsInTable.push(label);
                            break;
                        }
                    }
                });
                mapEl.innerHTML = labelsInTable.join('<br>');
            }
            const title = key === 'ä¸»' ? 'ä¸»æ¡Œ' : `ç¬¬ ${key} æ¡Œ`;
            indexContainer.innerHTML += `<b>${title} (${tables[key].length}äºº):</b> ${tables[key].join('ã€')}<br><hr style="border:0.5px solid #eee;">`;
        });
    }
    updateAll();
</script>

</body>
</html>
